#!/bin/bash
# Generates an SHA1 hash for directories or files.  Hashes generated for folders
# should only be compared if generated by this script.  Directories with name
# beginning with "." are ignored.

if [[ $# -eq 0 ]]
then
	echo "Usage: $0 path [...]"
	exit
fi

for path in "$@"
do
	if [[ -d $path ]]
	then
		sha=`find "$path" -type d -regex ".*/\..*" -prune -o -type f -print | sed 's/^\|$/"/g' | sort | xargs cat | sha1sum`
		echo ${sha/-/$path}
	else
		echo `sha1sum $path`
	fi
done
